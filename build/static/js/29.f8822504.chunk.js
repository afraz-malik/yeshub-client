(this.webpackJsonpyeshub=this.webpackJsonpyeshub||[]).push([[29],{359:function(e,t,a){"use strict";var n=a(3),l={uploadFile:function(e){return n.a.post("media/upload",e)},deleteFile:function(e){return n.a.delete("media/upload",{data:{file:e}})}};t.a=l},527:function(e,t,a){"use strict";a.r(t),a.d(t,"CommunityRules",(function(){return B}));var n=a(0),l=a.n(n),r=a(468),c=a.n(r),o=a(470),i=a(22),s=a(21),m=a(5),u=a(2),d=a(471),p=a.n(d),g=a(11),f=a(14),v=a(13),b=a(63),h=a(45),E=a(232),O=a(83),j=a(6),k=function(e){var t=e.onChange,a=e.onDragDrop,r=Object(n.useState)(0),c=Object(u.a)(r,2),o=c[0],i=c[1];return l.a.createElement("div",{className:"form-group",onDragOver:function(e){e.preventDefault(),i(2)},onDragLeave:function(e){console.log("drag leaved ..."),e.preventDefault(),i(0)},style:{border:"".concat(o,"px solid green")},onDragEnter:function(e){console.log("drag entered ...."),e.preventDefault(),i(2)},onDrop:a},l.a.createElement("div",{id:"drop-region"},l.a.createElement("div",{className:"drop-image"},l.a.createElement("div",{className:"feature_link"},l.a.createElement("label",null,l.a.createElement("span",null,l.a.createElement("img",{src:j.x,alt:"upload"}))))),l.a.createElement("div",{className:"drop-message"},"Drag & Drop images or click to upload"),l.a.createElement("input",{name:"image",type:"file",multiple:!0,onChange:function(e){return t(e,0)}}),l.a.createElement("div",{id:"image-preview"})))},w=function(e){var t=e.onChange,a=e.imagePreviews,n=e.onRemoveImage;return console.log("post images (previews)",a),l.a.createElement("div",{className:"form-group position-relative featured__image"},l.a.createElement("div",{className:"upload-post-image"},l.a.createElement("div",{className:"posted-image"},l.a.createElement("img",{src:a[0]?a[0]:j.o,className:"img-fluid",alt:"dummy"}),l.a.createElement("input",{name:"image",id:"some",className:"btn btn-primary",type:"file",onChange:function(e){return t(e,0)}}),l.a.createElement("div",{className:"removeImage"},l.a.createElement("button",{type:"button",onClick:function(){return n(0)}},l.a.createElement("img",{src:j.b,className:"img-fluid",alt:"dummy"})))),l.a.createElement("div",{className:"upload-image-button"},l.a.createElement("div",{className:"d-flex flex-wrap justify-content-center mt-3"},a.slice(1).map((function(e,a){return l.a.createElement("div",{className:"button-upload"},e?l.a.createElement("div",{className:"removeImage"},l.a.createElement("button",{type:"button",onClick:function(){return n(a+1)}},l.a.createElement("img",{src:j.b,className:"img-fluid",alt:"".concat(a+1)}))):null,l.a.createElement("label",{htmlFor:"image-".concat(a+1).concat(e?"e":"")},l.a.createElement("input",{type:"file",id:"image-".concat(a+1),onChange:function(e){return t(e,a+1)}}),l.a.createElement("img",{src:e||j.o,alt:"add"})))}))))))},y=function(e){var t=e.onChange,a=(e.onAddLinks,e.links);return l.a.createElement(l.a.Fragment,null,a.map((function(e,a){return l.a.createElement(n.Fragment,{key:a},l.a.createElement(h.a,{type:"text",name:"title",props:{placeholder:"Title"},onChange:function(e){return t(e,a)},defaultValue:e.title}),l.a.createElement(h.a,{type:"text",name:"url",props:{placeholder:"Url"},onChange:function(e){return t(e,a)},defaultValue:e.url}))})))},N=function(e){var t=e.onChange,a=e.videoUrl;return l.a.createElement(l.a.Fragment,null,l.a.createElement(h.a,{type:"text",name:"videoUrl",props:{placeholder:"Video Url"},onChange:t,defaultValue:a}),l.a.createElement("small",{className:"text-danger font-weight-bold"},"* Only YouTube video is allowed"))},x=a(12),C=a(32),D=a(8);var I=a(359),_=a(75),F=(a(473),a(474),a(476),a(478),a(480),a(482),a(484),a(486),a(487),a(488),a(497)),S=function(e){var t=e.value,a=e.height,n=e.onChange;return l.a.createElement(F.a,{initialValue:t,init:{height:a||"500px",menubar:!0,branding:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"undo redo | formatselect | bold italic backcolor | bullist numlist outdent indent |          alignleft aligncenter alignright alignjustify |           removeformat | link | help"},onEditorChange:function(e){n(e)}})},P="https://media4.giphy.com/media/3oEjI6SIIHBdRxXI40/200.gif",T={readonly:!1,buttons:["bold","strikethrough","underline","italic","eraser","superscript","subscript","ul","outdent","ol","indent","align","undo","redo","\n","selectall","cut","copy","paste","copyformat","|","hr","symbol","print","about"],allowResizeY:!0},U=function(){var e=Object(g.h)().state,t=Object(n.useState)([]),a=Object(u.a)(t,2),r=a[0],d=a[1],j=Object(n.useState)({images:!1,links:!1,video:!1}),F=Object(u.a)(j,2),U=F[0],L=F[1],A=Object(n.useState)({images:[],title:"",knowledgeGroup:e&&"community_detail"===e.create_from?e.community:"",link:r,roleId:"5e2fd51f34ce7375a792ffc4",isPublished:!0,tag:"",tags:[]}),G=Object(u.a)(A,2),B=G[0],Y=G[1],z=Object(n.useState)(e?e.description:""),H=Object(u.a)(z,2),J=H[0],M=(H[1],Object(n.useState)()),q=Object(u.a)(M,2),K=q[0],W=q[1],X=Object(n.useState)([]),Q=Object(u.a)(X,2),Z=Q[0],$=Q[1],ee=Object(n.useState)({show:!1}),te=Object(u.a)(ee,2),ae=te[0],ne=te[1],le=Object(n.useState)([]),re=Object(u.a)(le,2),ce=re[0],oe=re[1],ie=Object(n.useRef)(null);Object(n.useEffect)((function(){Y(Object(m.a)(Object(m.a)({},B),{},{link:r}))}),[r]),Object(n.useEffect)((function(){return window.addEventListener("click",(function(){setTimeout((function(){ne(Object(m.a)(Object(m.a)({},ae),{},{show:!1}))}),100)})),function(){window.removeEventListener("click",(function(e){}))}}),[]),Object(n.useEffect)((function(){U.links?d(r.concat({title:"",url:""})):d([])}),[U.links]),Object(n.useEffect)((function(){if(e&&"community_detail"!==e.create_from){var t,a=B;if(e.image.length){var n=e.image.map((function(e,t){return Object(x.a)(e)}));a.image=n}if(a.title=e.title,a.ID=e._id,a.knowledgeGroup=e.knowledgeGroup,Y(Object(m.a)({},a)),e.image.length){var l=ce;e.image.forEach((function(e){l.push(Object(x.a)(e))})),l.push(""),oe(Object(s.a)(ce)),L(Object(m.a)(Object(m.a)({},U),{},{images:!0})),console.log("previews",ce,U)}else oe([""]);if(W(e.description),0!==e.link.length&&(e.link.map((function(e){return delete e._id})),d(e.link)),e.videoUrl)Y(Object(m.a)(Object(m.a)({},B),{},{title:e.title,ID:e._id,knowledgeGroup:null===(t=e.knowledgeGroup)||void 0===t?void 0:t._id,videoUrl:e.videoUrl}));console.log("--- state ---"),console.log(e),console.log(ce),console.log("--- state ---")}else oe([""]);console.log("check previews ",ce),window.scrollTo(0,0)}),[]);var se=function(e){var t=p.a.mapValues(U,(function(){return!1}));L(Object(m.a)(Object(m.a)({},t),{},Object(i.a)({},e.currentTarget.id,!0)))},me=function(e){var t=e.target,a=t.type,n=t.name,l=t.value,r=t.checked;Y("checkbox"!==a?Object(m.a)(Object(m.a)({},B),{},Object(i.a)({},n,l)):Object(m.a)(Object(m.a)({},B),{},Object(i.a)({},n,r)))},ue=function(){var t=Object(o.a)(c.a.mark((function t(a,n){var l,r,o,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),a.target.files&&(l=Array.from(a.target.files),B,r=[],l.forEach((function(e){return r.push(P)})),e&&e._id&&l.forEach((function(t){var a=new FormData;a.append("images",t),C.a.updateImage(a,e._id)})),o=ce.length,i=[].concat(Object(s.a)(ce),r,[""]),oe(i),console.log("+++ previews",ce),Promise.all(l.map((function(e){return new Promise((function(t,a){var n=new FormData;n.append("images",e),I.a.uploadFile(n).then((function(e){t(e.data.data)}))}))}))).then((function(e){var t=B;e.forEach((function(e){t.images.push(e)})),ce.splice(o-1,e.length),Y(t),e=e.map((function(e){return Object(x.a)(e)})),oe([].concat(Object(s.a)(ce),Object(s.a)(e),[""]))})));case 2:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),de=function(e){_.a.create(e).then((function(e){console.log(e.data)})).catch((function(e){return console.log(e)})),B.tags.push(e),Y(Object(m.a)(Object(m.a)({},B),{},{tag:""})),ne({show:!1})},pe=function(t){var a;e&&e._id&&(console.log("on remove testing",e,B.images,t),C.a.deleteImage({ID:e._id,image:(a=B.images[t],console.log(D.o),a.replace("".concat(D.o,"/"),""))})),Y(Object(m.a)({},B)),I.a.deleteFile(B.images[t]),B.images.splice(t,1),ce.splice(t,1),oe(ce)},ge=function(e){setTimeout((function(){_.a.search(e).then((function(e){console.log("search results",e.data.data);var t=e.data.data.filter((function(e){return-1===B.tags.indexOf(e.name)}));$(t),e.data.data.length>0?ne({show:!0}):ne({show:!1})})).catch((function(e){console.log(e)}))}),200)};return l.a.createElement("div",{className:"cp-wrap"},l.a.createElement(O.a,{title:"Create Post",showDrafts:!1}),l.a.createElement("div",{className:"cp-form mt-3"},l.a.createElement("div",{className:"form-group"},l.a.createElement(E.a,{onSelect:me,selectedCommunity:B.knowledgeGroup})),l.a.createElement(b.a,{data:function(){var t=K?Object(m.a)(Object(m.a)({},B),{},{description:K}):Object(m.a)({},B);return e&&e._id&&(delete(t=Object(m.a)(Object(m.a)({},t),{},{ID:e._id})).images,delete t.roleId),console.log("---- data while creating post  ------"),console.log(t),console.log("---- data while creating post  ------"),t}(),submitUrl:"/general/post",validate:!0,isFormData:!1,props:{saveAsDraft:!0},className:"form mt-3",method:"POST",buttonText:"POST",refreshUser:!0,redirectUrl:"/communities",formId:"create_post"},l.a.createElement(h.a,{name:"title",type:"text",isRequired:!0,onChange:me,className:"form-control form-input2",props:{placeholder:"TITLE*"},defaultValue:B.title}),l.a.createElement("div",{className:"form-group"},l.a.createElement("div",{className:"d-flex flex-row"},l.a.createElement("div",{className:"feature_link",id:"images",onClick:se},l.a.createElement("label",null,l.a.createElement("span",{className:"mr-1"},l.a.createElement(v.a,{icon:f.v})),l.a.createElement("span",null,"Feature image/s"))),l.a.createElement("div",{className:"feature_link ml-2",id:"links",onClick:se},l.a.createElement("label",null,l.a.createElement("span",null,l.a.createElement(v.a,{icon:f.j})),l.a.createElement("span",null," Feature link"))),l.a.createElement("div",{className:"feature_link ml-2",id:"video",onClick:se},l.a.createElement("label",null,l.a.createElement("span",null,l.a.createElement(v.a,{className:"icon",icon:f.y})),l.a.createElement("span",null," Feature Video"))))),U.images&&!B.images[0]&&""===ce[0]?l.a.createElement(k,{onChange:ue,imagePreviews:ce,onRemoveImage:pe,onDragDrop:function(t){if(t.preventDefault(),t.dataTransfer.files){var a=Array.from(t.dataTransfer.files);e&&e._id&&a.forEach((function(t){var a=new FormData;a.append("images",t),C.a.updateImage(a,e._id)}));var n=[];a.forEach((function(e){return n.push(P)}));var l=[].concat(Object(s.a)(ce),n,[""]);oe(l),console.log("+++ previews",ce),Promise.all(a.map((function(e){return new Promise((function(t,a){var n=new FormData;n.append("images",e),I.a.uploadFile(n).then((function(e){t(e.data.data)}))}))}))).then((function(e){var t=B;e.forEach((function(e){t.images.push(e)})),ce.splice(ce.length-e.length-1,e.length),Y(t),ce.splice(ce.length-1,1),e=e.map((function(e){return Object(x.a)(e)})),oe([].concat(Object(s.a)(ce),Object(s.a)(e),[""]))}))}}}):U.images&&null!==B.images[0]&&""!==ce[0]&&l.a.createElement(w,{onChange:ue,imagePreviews:ce,onRemoveImage:pe}),U.links&&l.a.createElement(y,{onChange:function(e,t){var a=e.target,n=a.name,l=a.value,c=r;c[t]=Object(m.a)(Object(m.a)({},c[t]),{},Object(i.a)({},n,l)),d(c)},links:B.link,onAddLinks:function(){d(r.concat({title:"",url:""}))}}),U.video&&l.a.createElement(N,{videoUrl:B.videoUrl,onChange:me}),l.a.createElement("div",{className:"form-group"},l.a.createElement(S,{ref:ie,value:J,config:T,onChange:function(e){return function(e){W(e)}(e)}})),l.a.createElement("div",{style:{position:"relative"}},l.a.createElement("input",{name:"tag",type:"text",onChange:me,onKeyPress:function(e){return function(e){ge(e.target.value),13===e.charCode&&(de(e.target.value),e.preventDefault())}(e)},className:"form-control form-input2",value:B.tag,placeholder:"Add tag"}),ae.show&&l.a.createElement(V,{onItemClick:function(e,t){return de(e.name)},tags:Z})),l.a.createElement("div",{className:"d-flex flex-row",style:{marginBottom:"10px"}},B.tags.map((function(e,t){return l.a.createElement(R,{tag:e,onDelete:function(){return function(e,t){B.tags.splice(t,1),Y(Object(m.a)({},B))}(e.id,t)},key:t})}))))))},R=function(e){var t=e.tag,a=e.onDelete;return l.a.createElement("div",{style:{padding:"5px 2em 5px 10px",borderRadius:"50px",margin:"1em 1em 1em 0",display:"inline-block",position:"relative",backgroundColor:"yellow",color:"black"}},l.a.createElement("span",{onClick:function(e){return a(e)},style:{position:"absolute",top:"4px",right:"5px"}},L),l.a.createElement("span",null,t))},L=l.a.createElement("svg",{width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},l.a.createElement("circle",{cx:"10",cy:"10.2661",r:"10",fill:"white"}),l.a.createElement("path",{d:"M6 6.26611L14 14.2661M14 6.26611L6 14.2661",stroke:"#FFD300","stroke-width":"2"})),V=function(e){var t=e.tags,a=void 0===t?[]:t,n=e.onItemClick;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{style:{border:"1px solid lightgray",minWidth:"250px",display:"inline-block",position:"absolute",left:0,top:45,padding:"5px 15px",backgroundColor:"white",zIndex:123123}},a.map((function(e,t){return l.a.createElement("li",{className:"placeholder-list-item",style:{listStyle:"none"},onClick:function(){return n(e,t)}},"#".concat(e.name))}))))},A=a(118),G=a(4),B=function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"mc-border"},l.a.createElement("div",{className:"select-community-rules"},l.a.createElement("div",{className:"scr-wrap position-relative"},l.a.createElement("span",{className:"community-refresh-icon"},l.a.createElement("img",{src:j.s,alt:"Refresh"})),l.a.createElement("span",{className:"scr-link"},"Select a Community to load their rules")))),l.a.createElement("p",{className:"content-policy-note py-4"},"Please be mindful of YES!HUB",l.a.createElement(G.b,{to:"#"},"content policy")))};t.default=function(){return l.a.createElement(A.a,null,l.a.createElement(U,null))}}}]);
//# sourceMappingURL=29.f8822504.chunk.js.map